# Resume-Robot 项目梳理与优化建议

## 一、项目核心定位确认

### 1.1 核心价值
**简历机器人** - 帮助企业人事处理海量简历：
- ✅ **自动过滤**：将低质量简历自动过滤到"过滤箱"
- ✅ **智能匹配**：评估简历和岗位的匹配程度
- ✅ **候选人画像**：生成候选人画像和评估
- ✅ **风险识别**：评估风险点
- ✅ **推荐报告**：将高匹配简历形成推荐报告送给人事部门

### 1.2 关键成功因素
**大模型调用能力** - 这是项目的核心竞争力：
- 如何构建高质量的Prompt
- 如何整合组织架构信息到Prompt中
- 如何让大模型更好地理解岗位需求和评估候选人

## 二、当前实现分析

### 2.1 大模型调用现状

#### ✅ 已有能力
1. **LLMService** - 统一的LLM服务，支持多个provider（DeepSeek、豆包等）
2. **岗位画像解析** - `job_service.py` 使用LLM解析岗位描述和要求
3. **简历匹配分析** - `match_service.py` 使用LLM进行深度匹配分析
4. **公司信息增强** - 已经在Prompt中使用了公司信息

#### ⚠️ 不足之处
1. **组织架构信息缺失**：
   - 当前只有部门名称（字符串），没有部门表
   - 没有部门层级、部门职责、部门文化等信息
   - 无法构建包含组织架构信息的部门上下文

2. **Prompt构建分散**：
   - `match_service.py` 和 `job_service.py` 各自构建Prompt
   - 没有统一的Prompt构建服务
   - Prompt质量参差不齐

3. **公司信息不够丰富**：
   - 当前只有基础字段（name, industry, products等）
   - 缺少公司规模、发展阶段、核心价值观、招聘理念等

4. **部门信息缺失**：
   - 岗位只有 `department` 字符串字段
   - 没有关联到部门表
   - 无法获取部门的完整信息（职责、文化、风格等）

## 三、优化方案

### 3.1 核心设计理念

**组织架构信息融入Prompt上下文**：
```
公司信息（Company Context）
  ↓
部门信息（Department Context）- 包含组织架构信息（部门层级、路径、上级部门）
  ↓
岗位信息（Job Context）
  ↓
岗位画像（Job Profile）
  ↓
候选人简历（Candidate Resume）
```

**说明**：
- **组织架构**是数据结构（公司-部门-岗位的层级关系），不是Prompt的独立层级
- **组织架构信息**应该融入到**部门信息**中，作为部门上下文的一部分
- 通过组织架构信息，大模型可以理解岗位在组织中的位置、评估组织匹配、识别组织相关风险

**为什么重要**：
1. **上下文增强**：帮助大模型理解岗位在整个组织中的位置和作用
2. **文化匹配**：部门文化、公司文化影响对候选人的评估标准
3. **精准匹配**：不同部门即使岗位名称相同，要求也可能不同

### 3.2 实施步骤

#### 第一步：数据模型增强（优先级：高）

1. **创建Department表（组织架构）**
   - 支持多层级部门结构
   - 包含部门职责、文化、工作风格等信息
   - 用于Prompt增强

2. **增强CompanyInfo表**
   - 新增：公司规模、发展阶段、核心价值观、招聘理念等字段

3. **增强JobPosition表**
   - 将 `department` 字符串改为 `department_id` 外键
   - 关联到Department表

#### 第二步：创建Prompt构建服务（优先级：高）

1. **创建 `PromptBuilder` 服务类**
   - 统一管理所有LLM Prompt的构建
   - 提供方法：`build_company_context`, `build_department_context`（包含组织架构信息）, `build_job_context`
   - 提供完整Prompt构建：`build_match_analysis_prompt`, `build_job_parsing_prompt`

2. **Prompt层级结构**
   - 公司信息（Company Context）
   - 部门信息（Department Context）- 包含组织架构信息（部门层级、路径、上级部门）
   - 岗位信息（Job Context）
   - 岗位画像（Job Profile）
   - 候选人简历（Candidate Resume）

#### 第三步：服务层更新（优先级：中）

1. **更新 `match_service.py`**
   - 使用 `PromptBuilder` 构建匹配分析Prompt
   - 整合组织架构信息

2. **更新 `job_service.py`**
   - 使用 `PromptBuilder` 构建岗位解析Prompt
   - 整合组织架构信息

## 四、预期效果

### 4.1 Prompt质量提升

**之前**：
- 只有简单的公司信息（名称、行业、偏好）
- 只有部门名称，没有部门上下文
- 匹配分析不够深入

**之后**：
- 完整的公司上下文（规模、阶段、文化、理念）
- 完整的部门上下文（包含组织架构信息：部门层级、路径、上级部门、职责、文化、风格）
- 更精准的匹配分析（组织匹配、岗位匹配、文化匹配）

### 4.2 匹配精度提升

- **组织匹配**：评估候选人是否适合该部门/团队
- **文化匹配**：评估候选人是否匹配公司/部门文化
- **风险识别**：更准确地识别组织、文化、行业相关的风险点

## 五、实施建议

### 5.1 立即实施（核心功能）

1. **创建Department表和数据模型**
   - 这是基础，必须先完成
   - 支持多层级部门结构

2. **创建PromptBuilder服务**
   - 统一Prompt构建逻辑
   - 整合组织架构信息

3. **更新JobPosition表**
   - 添加 `department_id` 外键
   - 关联到Department表

### 5.2 后续优化

1. **增强CompanyInfo表**
   - 新增更多字段用于Prompt增强

2. **优化匹配分析Prompt**
   - 增加组织匹配、文化匹配的分析维度

3. **优化岗位解析Prompt**
   - 结合组织架构信息，更准确地提取岗位画像

## 六、总结

您的想法非常正确：**组织架构应该起到prompt的功能**。

通过将组织架构信息整合到Prompt中，可以让大模型：
1. **更好地理解岗位**：知道岗位在组织中的位置和作用
2. **更精准地匹配**：不仅看技能匹配，还看组织匹配和文化匹配
3. **更准确地评估**：识别组织、文化、行业相关的风险点

这是一个非常重要的优化方向，可以显著提升简历匹配的质量和准确性。

建议优先实施：
1. 创建Department表（组织架构）
2. 创建PromptBuilder服务（统一Prompt构建）
3. 更新JobPosition表（关联部门）

这样可以快速看到效果，然后逐步优化。

